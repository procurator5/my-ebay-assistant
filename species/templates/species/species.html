{% extends "__index.html" %}
{% load mptt_tags %}
{% load i18n %}

{% block title %} {{info.species_name}} {% endblock %}
{% block head %}
  <script src="https://www.google.com/jsapi"></script>
<style>
<!--
/* Базовый контейнер табов */
.tabs {
	min-width: 320px;
	max-width: 800px;
	padding: 0px;
	margin: 0 auto;
}
/* Стили секций с содержанием */
.tabs>section {
	display: none;
	padding: 15px;
	background: #fff;
	border: 1px solid #ddd;
}
.tabs>section>p {
	margin: 0 0 5px;
	line-height: 1.5;
	color: #383838;
	/* прикрутим анимацию */
	-webkit-animation-duration: 1s;
	animation-duration: 1s;
	-webkit-animation-fill-mode: both;
	animation-fill-mode: both;
	-webkit-animation-name: fadeIn;
	animation-name: fadeIn;
}
/* Описываем анимацию свойства opacity */
 
@-webkit-keyframes fadeIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}
@keyframes fadeIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}
/* Прячем чекбоксы */
.tabs>input {
	display: none;
	position: absolute;
}
/* Стили переключателей вкладок (табов) */
.tabs>label {
	display: inline-block;
	margin: 0 0 -1px;
	padding: 15px 25px;
	font-weight: 600;
	text-align: center;
	color: #aaa;
	border: 0px solid #ddd;
	border-width: 1px 1px 1px 1px;
	background: #f1f1f1;
	border-radius: 3px 3px 0 0;
}
/* Шрифт-иконки от Font Awesome в формате Unicode */
.tabs>label:before {
	font-family: fontawesome;
	font-weight: normal;
	margin-right: 10px;
}
.tabs>label[for*="1"]:before {
	content: "\f19a";
}
.tabs>label[for*="2"]:before {
	content: "\f17a";
}
.tabs>label[for*="3"]:before {
	content: "\f13b";
}
.tabs>label[for*="4"]:before {
	content: "\f13c";
}

/* Изменения стиля переключателей вкладок при наведении */
 
.tabs>label:hover {
	color: #888;
	cursor: pointer;
}
/* Стили для активной вкладки */
.tabs>input:checked+label {
	color: #555;
	border-top: 1px solid #009933;
	border-bottom: 1px solid #fff;
	background: #fff;
}
/* Активация секций с помощью псевдокласса :checked */
#tab1:checked~#content-tab1, #tab2:checked~#content-tab2, #tab3:checked~#content-tab3, #tab4:checked~#content-tab4 {
	display: block;
}
/* Убираем текст с переключателей 
* и оставляем иконки на малых экранах
*/
 
@media screen and (max-width: 680px) {
	.tabs>label {
		font-size: 0;
	}
	.tabs>label:before {
		margin: 0;
		font-size: 18px;
	}
}
/* Изменяем внутренние отступы 
*  переключателей для малых экранов
*/
@media screen and (max-width: 400px) {
	.tabs>label {
		padding: 15px;
	}
}

-->
</style>

{% endblock %}

{% block script %}
   google.load("visualization", "1", {packages:["corechart"]});
   google.setOnLoadCallback(drawChart);
   function drawChart() {
    var data = google.visualization.arrayToDataTable([
     ['price', 'count'],
 	{% for stat in stats %}    
     [
     '{{stat.line_end}}', {{stat.count}}
     ],
	{%  endfor %}
    ]);
    var options = {
     title: 'Price statistic',
     hAxis: {title: 'Price'},
     vAxis: {title: 'Counts'}
    };
    var chart = new google.visualization.ColumnChart(document.getElementById('statistic'));
    chart.draw(data, options);
   }
{% endblock script %}


{% block content %}
<a href="/species/">root </a> &raquo; 
<a href="/species/category/{{category.ebay_category_id}}">{{category.ebay_category_name}}</a>&raquo;
<a href="/species/genus/{{info.species_first_name}}">{{info.species_first_name}}</a> &raquo; 
<a href="/species/{{info.id}}">{{info.species_name}}</a>

<h1>{{info.species_name}}</h1>
<table>
  <tr>
    <td><img src="/media/{{info.species_photo}}" width='300'/></td>
    <td>
    	<h2>{% trans "Common properties" %}</h2>
    	{{info.species_first_name}}<br>
		{{info.species_last_name}}<br>  
		Category: {{info.ebay_category_name}} 
		<h2> {% trans "Price" %} </h2>
		
		<ul>
			<li>Avg price: {{info.avg}}</li>
			<li>Min price: {{info.min}}</li>
			<li>Max price: {{info.max}}</li>
		</ul> 
		<h2>Count of items</h2>
		Count: {{info.count}}
    </td>
  </tr>
</table>

<div class="tabs">
    <input id="tab1" type="radio" name="tabs" checked>
    <label for="tab1" title="Species">eBay Lots</label>
 
    <input id="tab2" type="radio" name="tabs">
    <label for="tab2" title="Species">Lots Statistics</label>

  <section id="content-tab1">
        <p>
			<table>
				{% for item in items %}
				<tr>
					<td><img alt="{{item.ebay_item_title}}" src="/media/{{item.ebay_gallery_icon}}" width="{{item.ebay_gallery_icon.width}}" height="{{item.ebay_gallery_icon.height}}"></td>
			    	<td>
			    		<a href="{{item.ebay_item_url}}" target="_blank">{{item.ebay_item_title}}</a><br>
			    		{{item.ebay_item_price}} $
			    	
			    	</td>
			    </tr>
				{%  endfor %}
			</table>
		</p>
</section>

  <section id="content-tab2">
        <p>
  			<div id="statistic"></div>
		</p>
  </section>
</div>

{% endblock %}

{% block sidenav %}
				<h2>Categories</h2>
				<ul class="root">
				    {% recursetree nodes %}
				        <li>
				        <a href="/species/category/{{node.ebay_category_id}}/">
				            {{ node.space }} {{ node.ebay_category_name }}
				        </a>
			            {% if not node.is_leaf_node %}
			                <ul class="children">
			                   {{ children }}
			                </ul>
			            {% endif %}
	               {% endrecursetree %}
				</ul>		
{% endblock %}